<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projektvisning</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Denna klass styr själva svepet */
        #slider-inner {
            display: flex;
            transition: transform 0.5s ease-in-out;
            width: 100%;
        }
        .slide {
            min-width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            background: black;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-900 font-sans">

    <div class="max-w-4xl mx-auto py-10 px-4">
        <a href="index.html" class="text-blue-600 hover:underline mb-6 inline-block font-medium">← Tillbaka till översikten</a>

        <div id="project-content" class="bg-white p-8 rounded-xl shadow-lg">
            <h1 id="title" class="text-4xl font-bold mb-4">Laddar...</h1>
            <p id="description" class="text-gray-600 mb-8"></p>

            <div class="relative group overflow-hidden rounded-lg shadow-inner bg-black">
                <div id="slider-inner">
                    </div>

                <button onclick="prevSlide()" class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/40 text-white p-3 rounded-full hover:bg-black/70 transition-all backdrop-blur-sm">❮</button>
                <button onclick="nextSlide()" class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/40 text-white p-3 rounded-full hover:bg-black/70 transition-all backdrop-blur-sm">❯</button>
                
                <div id="dots" class="absolute bottom-4 left-1/2 -translate-x-1/2 flex gap-2"></div>
            </div>
        </div>
    </div>

    <script>
        const params = new URLSearchParams(window.location.search);
        const id = params.get('id');
        let currentIndex = 0;
        let totalImages = 0;

        async function loadProject() {
            try {
                const res = await fetch(`content/${id}/info.json`);
                const data = await res.json();
                
                document.getElementById('title').innerText = data.projectName;
                document.getElementById('description').innerText = data.fullText;
                
                const sliderInner = document.getElementById('slider-inner');
                const dotsContainer = document.getElementById('dots');
                totalImages = data.images.length;

                // Skapa alla slides på en gång
                data.images.forEach((imgName, i) => {
                    // Skapa slide
                    const slideDiv = document.createElement('div');
                    slideDiv.className = 'slide aspect-video';
                    slideDiv.innerHTML = `<img src="content/${id}/${imgName}" class="max-h-full max-w-full object-contain">`;
                    sliderInner.appendChild(slideDiv);

                    // Skapa prick
                    const dot = document.createElement('div');
                    dot.className = `h-2 w-2 rounded-full bg-white/50 cursor-pointer transition-all`;
                    dot.onclick = () => goToSlide(i);
                    dotsContainer.appendChild(dot);
                });

                updateSlider();
            } catch (err) {
                document.getElementById('project-content').innerHTML = "Projektet kunde inte hittas.";
            }
        }

        function updateSlider() {
            const sliderInner = document.getElementById('slider-inner');
            // Flytta hela raden horisontellt
            sliderInner.style.transform = `translateX(-${currentIndex * 100}%)`;
            
            // Uppdatera prickar
            const dots = document.getElementById('dots').children;
            for (let i = 0; i < dots.length; i++) {
                dots[i].classList.toggle('bg-white', i === currentIndex);
                dots[i].classList.toggle('w-4', i === currentIndex); // Gör aktiv prick lite bredare
                dots[i].classList.toggle('bg-white/50', i !== currentIndex);
            }
        }

        function nextSlide() {
            currentIndex = (currentIndex + 1) % totalImages;
            updateSlider();
        }

        function prevSlide() {
            currentIndex = (currentIndex - 1 + totalImages) % totalImages;
            updateSlider();
        }

        function goToSlide(index) {
            currentIndex = index;
            updateSlider();
        }

        loadProject();
    </script>
</body>
</html>